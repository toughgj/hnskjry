# 实现自动翻页功能

## 需求分析
1. 检测当前页面所有课程是否都是100%
2. 如果都是100%，自动点击下一页
3. 翻页后重新收集课程，继续处理
4. 与现有脚本集成，不影响原有功能

## 实现方案

### 1. 检测当前页面课程进度
- 在`collectUnfinishedCourses`函数中添加检测逻辑
- 检查所有课程的进度是否都是100%
- 返回检测结果，用于判断是否需要翻页

### 2. 实现翻页逻辑
- 查找翻页区域：`.pages-num`
- 找到当前页码：带有`current`类的a标签
- 找到下一个页码：当前页码的下一个兄弟元素
- 点击下一个页码的a标签
- 如果没有下一页，结束处理

### 3. 与现有脚本集成
- 在`setupListPage`函数中添加翻页检测
- 翻页后重新收集课程
- 确保翻页逻辑与现有漂浮窗口功能兼容
- 尊重用户的选择，只在必要时翻页

### 4. 测试方案
- 模拟当前页面所有课程都是100%的情况
- 检查是否能自动翻页
- 检查翻页后是否能继续收集和处理课程

## 实现步骤

1. **修改`collectUnfinishedCourses`函数**：
   - 添加检测当前页面所有课程是否都是100%的逻辑
   - 返回检测结果

2. **添加`checkAndTurnPage`函数**：
   - 查找翻页区域
   - 找到当前页码和下一个页码
   - 点击下一个页码
   - 重新收集课程

3. **修改`setupListPage`函数**：
   - 在收集完课程后调用翻页检测
   - 如果需要翻页，执行翻页操作
   - 否则显示漂浮窗口

4. **优化代码结构**：
   - 确保代码逻辑清晰，易于维护
   - 添加适当的日志输出
   - 确保不影响原有功能

## 预期效果
- 当前页面所有课程都是100%时，自动点击下一页
- 翻页后重新收集课程，继续处理
- 与现有漂浮窗口功能兼容
- 提供清晰的日志输出，便于调试

## 实现代码结构
```javascript
/**
 * 收集未完成课程
 * @param {HTMLElement} table - 课程表格元素
 * @returns {boolean} - 当前页面是否所有课程都是100%
 */
function collectUnfinishedCourses(table) {
    // 原有逻辑...
    
    // 检测当前页面所有课程是否都是100%
    const allCompleted = courseRows.every(row => {
        // 检查课程进度是否为100%
        // ...
    });
    
    return allCompleted;
}

/**
 * 检查并执行翻页
 */
function checkAndTurnPage() {
    // 查找翻页区域
    const pagesNum = document.querySelector('.pages-num');
    if (!pagesNum) return false;
    
    // 找到当前页码
    const currentPage = pagesNum.querySelector('a.current');
    if (!currentPage) return false;
    
    // 找到下一个页码
    const nextPage = currentPage.nextElementSibling;
    if (!nextPage) return false;
    
    // 点击下一个页码
    nextPage.click();
    
    // 重新收集课程
    setTimeout(() => {
        setupListPage();
    }, config.pageLoadDelay);
    
    return true;
}

/**
 * 设置列表页面的处理逻辑
 */
function setupListPage() {
    // 原有逻辑...
    
    // 收集未完成课程
    const allCompleted = collectUnfinishedCourses(table);
    
    // 如果有未完成课程，显示漂浮窗口
    if (courseQueue.length > 0) {
        // 原有逻辑...
    } else if (allCompleted) {
        // 当前页面所有课程都是100%，尝试翻页
        originalConsoleLog('当前页面所有课程已完成，尝试翻页...');
        checkAndTurnPage();
    } else {
        originalConsoleLog('所有课程已完成，无需处理');
    }
}
```