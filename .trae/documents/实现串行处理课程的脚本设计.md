# 实现串行处理课程的脚本设计

## 需求分析
1. 保持原有逻辑：查找未完成课程，检查进度是否100%
2. 串行处理：一个课程完成后再处理下一个
3. 监听播放完成事件：通过console提示判断课程播放完毕
4. 控制页面打开：确保一次只打开一个页面

## 实现方案
1. **收集未完成课程**：遍历所有课程，收集进度未达100%的课程
2. **串行处理队列**：使用队列存储未完成课程，按顺序处理
3. **监听console事件**：重写console.log，检测播放完成提示
4. **控制页面打开**：一次只打开一个课程页面，等待播放完成后再打开下一个
5. **添加延迟机制**：确保页面有足够时间加载和播放

## 代码结构
```javascript
// 1. 收集未完成课程函数
function collectUnfinishedCourses(table) {
    // 遍历课程，返回未完成课程数组
}

// 2. 处理课程队列函数
function processCourseQueue(queue) {
    // 按顺序处理队列中的课程
}

// 3. 监听console事件函数
function setupConsoleListener() {
    // 重写console.log，检测播放完成提示
}

// 4. 打开课程页面函数
function openCourse(course) {
    // 打开单个课程页面
}

// 5. 主流程控制
function initScript() {
    // 查找元素 -> 收集未完成课程 -> 设置监听 -> 开始处理队列
}
```

## 关键技术点
1. 使用数组作为队列，通过shift()方法获取下一个课程
2. 重写console.log方法，捕获播放完成事件
3. 使用setTimeout控制页面打开延迟
4. 保持脚本的鲁棒性和可维护性

## 预期效果
1. 脚本启动后，自动查找所有未完成课程
2. 按顺序打开第一个课程页面
3. 课程播放完成后，检测到console提示
4. 关闭当前页面（或等待页面自动关闭）
5. 打开下一个课程页面，重复上述过程
6. 所有课程处理完成后，脚本结束

## 注意事项
1. 需要准确识别播放完成的console提示文本
2. 需要处理页面加载超时的情况
3. 需要确保一次只打开一个页面
4. 需要处理各种异常情况，如页面无法打开、播放失败等