# 在悬浮窗中添加下一页按钮测试功能

## 需求分析
1. 在悬浮窗中添加一个"测试下一页"按钮
2. 点击该按钮可以手动测试下一页功能
3. 与现有功能兼容，不影响原有逻辑
4. 提供清晰的反馈信息

## 实现方案

### 1. UI设计
- 在悬浮窗的信息栏中添加一个"测试下一页"按钮
- 按钮样式与现有按钮保持一致
- 放置在信息栏中，与下一页状态提示在一起

### 2. 功能实现
- 添加testNextPageBtn函数，用于测试下一页按钮
- 绑定按钮点击事件
- 提供清晰的反馈信息
- 确保与现有功能兼容

### 3. 与现有脚本的集成
- 在createFloatingWindow函数中添加测试按钮
- 在bindFloatingWindowEvents函数中绑定事件
- 确保不影响原有功能

## 实现步骤

1. **修改createFloatingWindow函数**：
   - 在悬浮窗的信息栏中添加"测试下一页"按钮
   - 按钮样式与现有按钮保持一致

2. **修改bindFloatingWindowEvents函数**：
   - 为"测试下一页"按钮绑定点击事件
   - 调用testNextPageBtn函数

3. **添加testNextPageBtn函数**：
   - 查找下一页按钮
   - 点击下一页按钮
   - 提供清晰的反馈信息
   - 处理异常情况

4. **优化代码结构**：
   - 确保代码逻辑清晰，易于维护
   - 添加适当的日志输出
   - 确保不影响原有功能

## 预期效果
- 悬浮窗中显示"测试下一页"按钮
- 点击按钮可以手动测试下一页功能
- 提供清晰的反馈信息
- 与现有功能兼容

## 实现代码结构
```javascript
/**
 * 创建左上角漂浮窗口
 */
function createFloatingWindow() {
    // 原有代码...
    
    // 构建HTML结构
    floatingWindow.innerHTML = `
        <!-- 原有HTML结构... -->
        
        <div style="font-size: 12px; color: #666; border-top: 1px solid #eee; padding-top: 10px;">
            <div>下一页按钮：<span style="color: ${hasNextPage ? '#4CAF50' : '#f44336'}; font-weight: bold;">${hasNextPage ? '已找到' : '未找到'}</span></div>
            <div style="margin-top: 5px;">
                <button id="test-next-btn" style="background: #2196F3; color: white; border: none; border-radius: 4px; padding: 3px 8px; cursor: pointer; font-size: 11px;">测试下一页</button>
                <span style="margin-left: 10px;">提示：当前页面课程完成后${hasNextPage ? '将自动翻页' : '无下一页'}</span>
            </div>
        </div>
    `;
    
    // 原有代码...
}

/**
 * 绑定漂浮窗口事件
 */
function bindFloatingWindowEvents() {
    // 原有事件绑定...
    
    // 测试下一页按钮
    document.getElementById('test-next-btn').addEventListener('click', () => {
        testNextPageBtn();
    });
}

/**
 * 测试下一页按钮
 */
function testNextPageBtn() {
    const nextPageBtn = document.querySelector('.next.ng-binding');
    if (nextPageBtn) {
        originalConsoleLog('测试点击下一页按钮');
        nextPageBtn.click();
    } else {
        originalConsoleLog('未找到下一页按钮，无法测试');
        alert('未找到下一页按钮，无法测试');
    }
}
```